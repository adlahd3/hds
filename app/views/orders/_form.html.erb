<%= form_for(@order, :html => {:multipart => true}) do |f| %>
    <% if @order.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@order.errors.count, "error") %> prohibited this order from being saved:</h2>

          <ul>
            <% @order.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
            <% end %>
          </ul>
        </div>
    <% end %>

    <div class="field">
      <%= f.label :customer_id %>
      <br>
      <%= collection_select(:order, :customer_id, Customer.all, :id, :name, :include_blank => "Choose a customer") %>
    </div>
    <div class="field">
      <%= f.label :address_id %>
      <br>
      <%= collection_select(:order, :address_id, Address.all, :id, :lat) %>
    </div>
    <div class="field">
      <%= f.label :bill_number %>
      <br>
      <%= f.text_field :bill_number %>
    </div>
    <div class="field">
      <%= f.label :note %>
      <br>
      <%= f.text_area :note %>
    </div>
    <div class="field">
      <%= f.label :bill_image %>
      <br>
      <%= f.file_field :bill_image %>
    </div>
    <div class="actions">
      <%= f.submit %>
    </div>
<% end %>

<script>
    $(document).ready(function () {

        // Dropdown Stuff.

        $('#order_address_id').attr('disabled', true);
        $('#order_customer_id').change(function () {
            $('#order_address_id').find('option')
                    .remove()
                    .end();
            $.ajax({
                type: "GET",
                dataType: "json",
                url: "/ajax/get_addresses/" + $('#order_customer_id').val(),
                success: function (data) {
                    $.each(data, function (index, element) {
                        $('#order_address_id')
                                .append($("<option></option>")
                                        .attr("value", element.id)
                                        .text("D"));
                    });
                    $('#order_address_id').attr('disabled', false);
                },
                error: function (data) {
                    alert("error");
                }
            });
            return false;
        });
    });
</script>
